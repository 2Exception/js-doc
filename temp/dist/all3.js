!function(a){"use strict";a.tools={getURLParameter:function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),i=window.location.search.substr(1).match(e);return null!=i?i[2]:null},simString:function(t,e){e="short"==e;for(var i="",n="",s=a.encodeURI,r=0;r<t.length;r++)n=t.substr(r,1),/[\u4e00-\u9fa5]/.test(n)?(s(n).split("%").forEach(function(t){""==t?n=[]:n.push(parseInt("0x"+t))}),i+=e?(n[0]+n[1]+n[2]).toString(16).substr(-1,1):(n[0]+n[1]+n[2]).toString(16).substr(-2,2)):i+=n;return i},formatJson:function(t){var e=decodeURI(t.replace(/%([^0-9A-Z]{0,2})/g,"%25$1")),i=null,r="",a=0,n={};return n.newlineAfterColonIfBeforeBraceOrBracket=!0===n.newlineAfterColonIfBeforeBraceOrBracket,n.spaceAfterColon=!1!==n.spaceAfterColon,"string"!=typeof e||(e=JSON.parse(e)),i=/([\{\}])/g,e=(e=JSON.stringify(e)).replace(i,"\r\n$1\r\n"),i=/([\[\]])/g,e=e.replace(i,"\r\n$1\r\n"),i=/(\,)/g,e=e.replace(i,"$1\r\n"),i=/(\r\n\r\n)/g,e=e.replace(i,"\r\n"),i=/\r\n\,/g,e=e.replace(i,","),n.newlineAfterColonIfBeforeBraceOrBracket||(i=/\:\r\n\{/g,e=e.replace(i,":{"),i=/\:\r\n\[/g,e=e.replace(i,":[")),n.spaceAfterColon&&(i=/"\s*\:/g,e=e.replace(i,'": ')),$.each(e.split("\r\n"),function(t,e){var i=0,n=0,s="";for(e.match(/\{$/)||e.match(/\[$/)?n=1:e.match(/\}/)||e.match(/\]/)?0!==a&&(a-=1):n=0,i=0;i<a;i++)s+="    ";r+=s+e+"\r\n",a+=n}),r},formatTime:function(t){var e=new Date(t),i=e.getFullYear()+"",n=e.getMonth()+1;n=n<=9?"0"+n:n;var s=e.getDate();s=s<=9?"0"+s:s;var r=e.getHours();r=r<=9?"0"+r:r;var a=e.getMinutes();a=a<=9?"0"+a:a;var o=e.getSeconds();return i+"-"+n+"-"+s+" "+r+":"+a+":"+(o=o<=9?"0"+o:o)}}}(window),function(s){"use strict";var r=s.tools,t=r.simString(s.location.pathname.replace("/","").replace(/\//g,"_")).toUpperCase(),e="AMWikiDataBase@"+t,i="AMWikiStates@"+t,n=function(){this._db=null,this._states=null,this.$e={win:$(s),searchUpdate:$("#searchUpdate"),cacheState:$("#cacheState"),cacheDocTotal:$("#cacheDocTotal"),cacheLasttime:$("#cacheLasttime")},this._bridgeLocalStorage("read"),this._bindCtrl()};n.prototype._bridgeLocalStorage=function(t){if("read"==t){this._db=JSON.parse(s.localStorage[e]||'{"documents":{},"lastBuild":0}'),void 0!==this._db.libraries&&(this._db.documents=this._db.libraries,delete this._db.libraries)}else"save"==t&&(s.localStorage[e]=JSON.stringify(this._db))},n.prototype._bindCtrl=function(){var t=this;this.$e.win.on("beforeunload",function(){t._bridgeLocalStorage("save")})},n.prototype.update=function(t,e){var i=r.simString(t,"short");return this._db.documents[i]?this._db.documents[i].content!=e&&(this.saveDoc(t,e,i),!0):(this.saveDoc(t,e,i),!0)},n.prototype.saveDoc=function(t,e,i){this.saveDocToDB(t,e,i),this._bridgeLocalStorage("save"),this._changeSummary("sateOnly")},n.prototype.saveDocToDB=function(t,e,i){if("string"!=typeof t&&""==t)throw new Error("Error, uri must be a string!");void 0===i&&(i=r.simString(t,"short")),this._db.documents[i]={id:i,uri:t,content:e||"",timestamp:Date.now()},this._changeSummary("sateOnly","prepare")},n.prototype.read=function(t){var e=r.simString(t,"short"),i="";return this._db.documents[e]&&(i=this._db.documents[e].content),i},n.prototype.readTime=function(t){var e=r.simString(t,"short");return this._db.documents[e]?this._db.documents[e].timestamp:0},n.prototype.remove=function(t){var e=r.simString(t,"short");delete this._db.documents[e],this._bridgeLocalStorage("save"),this._changeSummary("sateOnly")},n.prototype.increaseOpenedCount=function(t){r.simString(t,"short")},n.prototype.checkLibChange=function(t){this._indexing=t;for(var e={},i="",n=0;n<t.length;n++)i=r.simString(t[n],"short"),void 0!==this._db.documents[i]&&(e[i]=this._db.documents[i]);this._db.documents=e,this._bridgeLocalStorage("save"),this._changeSummary()},n.prototype._changeSummary=function(t,e){var i=0;for(var n in this._db.documents)this._db.documents.hasOwnProperty(n)&&i++;"prepare"==e?this.$e.cacheState.text(parseInt(i/this._indexing.length*100-1)+"%"):this.$e.cacheState.text(parseInt(i/this._indexing.length*100)+"%"),"stateOnly"!=t&&(this.$e.cacheDocTotal.text(this._indexing.length),this._db.lastBuild?this.$e.cacheLasttime.text(s.tools.formatTime(this._db.lastBuild)):this.$e.cacheLasttime.text("0000-00-00 00:00:00"))},n.prototype.clearLibraries=function(){this._db.documents={},this._changeSummary("sateOnly")},n.prototype.saveRebuild=function(){this._db.lastBuild=Date.now(),this._bridgeLocalStorage("save"),this._changeSummary()},n.prototype.getIndexList=function(){return this._indexing},n.prototype.getAllDocs=function(){return this._db.documents},n.prototype.getLastBuildTs=function(){return this._db.lastBuild},n.prototype.getStates=function(t){return this._states||(this._states=JSON.parse(s.localStorage[i]||"{}")),this._states[t]},n.prototype.setStates=function(t,e){this._states||(this._states=JSON.parse(s.localStorage[i]||"{}")),void 0===e?delete this._states[t]:this._states[t]=e,s.localStorage[i]=JSON.stringify(this._states)},s.AWStorage=n}(window),function(s){"use strict";var t=function(t){this._storage=t,this.$e={searchShow:$("#searchShow"),searchUpdate:this._storage.$e.searchUpdate,searchBox:$("#searchBox"),results:$("#results"),resultMsg:$("#resultMsg"),resultMore:$("#resultMore"),search:$("#search"),searchText:$("#searchText")},this._data={result:[],template:$("#template\\:searchResult").text(),pageSize:15,pagination:0},this._bindCtrl(),this.onNeedRebuildStorage=null};t.prototype._bindCtrl=function(){var i=this;this.$e.searchShow.on("click",function(){i.$e.searchBox.hasClass("on")?(i.displayBox("off"),i.$e.searchShow.trigger("searchoff")):(i.displayBox("on",function(){t()}),i.$e.searchShow.trigger("searchon"))});var t=function(){var t=i.$e.searchBox.height(),e=i.$e.results.offset().top-i.$e.searchUpdate.offset().top;i.$e.results.height(t-e)};$(s).on("resize",function(){i.$e.searchBox.hasClass("on")&&t()}),"file:"==location.protocol&&"undefined"!=typeof AWPageMounts&&this.$e.searchUpdate.parent().addClass("off"),this.$e.searchUpdate.on("click",function(){i._worker&&(i._worker.terminate(),i._worker=null,i.$e.resultMsg.hide()),i.$e.search.prop("disabled",!0),i.$e.searchUpdate.prop("disabled",!0),i.onNeedRebuildStorage(function(){i.$e.search.prop("disabled",!1),i.$e.searchUpdate.val("请勿频繁使用")})});var e=this._storage.getLastBuildTs();e&&(Date.now()-e<36e5&&this.$e.searchUpdate.prop("disabled",!0).val("请勿频繁使用"));this.$e.search.on("click",function(){i._search()}),this.$e.searchText.on("keyup",function(t){13==t.keyCode&&i._search()}),this.$e.resultMore.on("click",function(){i._nextResultPage()})},t.prototype.displayBox=function(t,e){var i=this.$e.searchBox;"on"!=t||i.hasClass("on")?"off"==t&&i.hasClass("on")&&i.removeClass("on").animate({width:"30%",opacity:0},200,"swing",function(){i.removeAttr("style"),e&&e()}):i.addClass("on").css({display:"block",width:"0",opacity:0}).animate({width:"100%",opacity:1},300,"swing",function(){e&&e()})},t.prototype._search=function(){if(""!=this.$e.searchText.val()){var e=this.$e.searchText.val();if(this.$e.resultMsg.show().text("创建搜索中..."),void 0!==s.Worker){this._worker&&(this._worker.terminate(),this._worker=null,this.$e.resultMsg.hide());try{this._worker=new s.Worker("amWiki/js/amWiki.search.worker.js"),this._searchByWorker(e)}catch(t){this._searchByPresent(e)}}else this._searchByPresent(e)}else this.$e.searchText.focus()},t.prototype._searchByWorker=function(i){var n=this;this._worker.onmessage=function(t){var e=t.data;"searcher:loaded"==e.type?n._worker.postMessage({type:"searcher:docs",docs:n._storage.getAllDocs()}):"searcher:ready"==e.type?(n.$e.resultMsg.show().html("正在搜索，请稍后..."),n._worker.postMessage({type:"searcher:search",words:i})):"searcher:result"==e.type&&(n._data.result=e.result,n._showResultList(),n._worker.terminate(),n._worker=null)},this._worker.onerror=function(t){console.error(t),this.$e.resultMsg.show().text("Sorry，出错了！<br/>"+t.msg),n._worker.terminate(),n._worker=null}},t.prototype._searchByPresent=function(t){var e=new AWSearcher;e.initDocs(this._storage.getAllDocs()),this.$e.resultMsg.show().html("正在搜索，请稍后..."),e.matchWords(t),this._data.result=e.getResult(),this._showResultList()},t.prototype._showResultList=function(){this.$e.results.children("ul").children().remove(),this.$e.resultMsg.hide(),this._data.pagination=0,this._nextResultPage()},t.prototype._nextResultPage=function(){for(var t,e="",i=0,n=this._data.pagination*this._data.pageSize;(t=this._data.result[n])&&(e+=this._renderRankItem(this._data.template,t),!(++i>=this._data.pageSize));n++);this.$e.results.children("ul").append(e),this._data.pagination++,this._data.pagination*this._data.pageSize>=this._data.result.length?this.$e.resultMore.hide():this.$e.resultMore.show()},t.prototype._renderRankItem=function(t,e){var i=t;for(var n in e.time=s.tools.formatTime(e.timestamp),delete e.timestamp,e)e.hasOwnProperty(n)&&(i=i.replace(new RegExp("{{"+n+"}}","g"),e[n]));return i},s.AWSearch=t}(window),function(i){"use strict";var n=void 0===i.jQuery;if(function(){var t=function(){this._documents=null,this._processing={},this._data={titleScore:100,apiScore:50,textScore:5}};return t.prototype.initDocs=function(t){for(var e in this._documents=n?t:JSON.parse(JSON.stringify(t)),this._documents)this._documents.hasOwnProperty(e)&&this._preDoc(this._documents[e])},t.prototype._preDoc=function(s){s.content=s.content.replace(/^\s+|\s+$/g,"").replace(/^#\s?(.*?)[\r|\n]/,function(t,e){return s.title=e,""}).replace(/([^#]#{3} *请求地址[\n\r]{1,4})([-\w:\/\.]+?)[\n\r]{1,}(#{3} *请求类型[\s\S]+?#{3} *请求参数)/,function(t,e,i,n){return s.api=i,e+n}).replace(/#{1,6}(.*?)#{0,6}\s*[\r\n]/g,"$1").replace(/[_\*~]{1,2}(.*?)[_\*~]{1,2}/g,"$1").replace(/!\[.*?]\(.*?\)/g,"").replace(/\[(.*?)]\(.*?\)/g,"$1").replace(/`{3}.*?[\n\r]([\s\S]*?)`{3}/g,"$1").replace(/`(.*?)`/g,"$1").replace(/<.+?>/g,"").replace(/> *(.+?)[n\r]/g,"$1").replace(/-{3,} *[\n\r]/g,"").replace(/(\|.*?[\n\r]{1,2}){3,}/g,function(t){return t.replace(/\|.*?[\n\r]{1,2}/g,function(t){return 0<=t.indexOf("---")?"":t.replace(/\|/g,"")})}).replace(/[\n\r\t]/g," ").replace(/\s{2,}/g," ")},t.prototype._addPorcessing=function(t,e,i){void 0===this._processing[t]?(this._processing[t]={},this._processing[t][e]=i):void 0===this._processing[t][e]?this._processing[t][e]=i:this._processing[t][e]+=i},t.prototype.matchWords=function(t){var e=new RegExp(t,"gi");for(var i in this._documents)if(this._documents.hasOwnProperty(i)){if(this._documents[i].title){var n=this._documents[i].title.match(e);if(n&&0<n.length){var s=this._documents[i].title.replace(e,function(t){return"<mark>"+t+"</mark>"});this._addPorcessing(i,"title",s),this._addPorcessing(i,"score",this._data.titleScore)}}if(this._documents[i].api){var r=this._documents[i].api.match(e);if(r&&0<r.length){var a='<p class="p1"><em>接口</em>'+this._documents[i].api.replace(e,function(t){return"<mark>"+t+"</mark>"})+"</p>";this._addPorcessing(i,"api",a),this._addPorcessing(i,"score",this._data.apiScore)}}var o=this._documents[i].content.match(new RegExp(".{0,15}"+t+".{0,30}","gi"));if(o){for(var c,l="<p>",h=0;c=o[h];h++)h<2&&(l+=c.replace(e,function(t){return"<mark>"+t+"</mark>"})+"... ");l+="</p>",this._addPorcessing(i,"content",l),this._addPorcessing(i,"score",o.length*this._data.textScore)}}this._auxiliary()},t.prototype._auxiliary=function(){},t.prototype._sortByScore=function(){var t=[];for(var e in this._processing)this._processing.hasOwnProperty(e)&&(void 0===this._processing[e].title&&(this._processing[e].title=this._documents[e].title?this._documents[e].title:""),void 0===this._processing[e].api&&(this._processing[e].api=""),void 0===this._processing[e].content&&(this._processing[e].content="<p>"+this._documents[e].content.substr(0,45)+"...</p>"),this._processing[e].path=this._documents[e].uri,this._processing[e].timestamp=this._documents[e].timestamp,t.push(this._processing[e]));return t.sort(function(t,e){return t.score>e.score?-1:1}),t},t.prototype.getResult=function(){return this._sortByScore()},this.AWSearcher=t}.call(i),n){var s=new i.AWSearcher;i.onmessage=function(t){var e=t.data;"searcher:docs"==e.type?(s.initDocs(e.docs),i.postMessage({type:"searcher:ready"})):"searcher:search"==e.type&&(s.matchWords(e.words),i.postMessage({type:"searcher:result",result:s.getResult()}))},i.postMessage({type:"searcher:loaded"})}}(self),function(t,e,l){"use strict";var r=t.hljs,a=t.marked,o="AMWikiUrlEncode",i=function(){this.$e={win:l(t),view:l("#view"),title:l("title"),contentsTitle:l("#contentsTitle")},this.data={pageWidth:0},this._initUrlEncode(),this._initHashEvent()};i.prototype._initUrlEncode=function(){localStorage[o]?"utf8"!=localStorage[o]&&"gbk"!=localStorage[o]&&(localStorage[o]="utf8"):localStorage[o]="utf8",delete localStorage.urlEcode},i.prototype._initHashEvent=function(){var r=this;this.data.pageWidth=this.$e.win.width(),this.$e.win.on("resize",function(){r.data.pageWidth=r.$e.win.width()}),this.$e.win.on("hashchange",function(t){var s=location.hash.split("#")[1];r.data.pageWidth<=720&&r.$e.view.find("h1,h2,h3").each(function(t,e){var i=l(e),n=i.text().replace(/\s+/g,"");s==n&&r.$e.win.scrollTop(i.offset().top-55)})})},i.prototype._tramsformLinkText=function(t){return t.replace(/^\s+|\s+$/g,"").replace(/'/g,"&#39;").replace(/"/g,"&#34;").replace(/\(/g,"&#40;").replace(/\)/g,"&#41;").replace(/\[/g,"&#91;").replace(/\]/g,"&#93;")},i.prototype._setTitlesAnchor=function(){var r=this,a="",o="";location.hash&&1<location.hash.length&&(a=location.hash.split("#")[1]);var c='<a class="anchor" href="#{title}" name="{title}"><svg><use xlink:href="#icon:linkAnchor"></use></svg></a>';return r.$e.view.find("h1,h2,h3").each(function(t,e){var i=l(e),n=r._tramsformLinkText(i.text()),s=n.replace(/&#34;/g,"");i.is("h2")?o+="1. ["+n+"](#"+s+' "'+s+'")\n':i.is("h3")&&(o+="\t1. ["+n+"](#"+s+' "'+s+'")\n'),i.prepend(c.replace(/{title}/g,s)),a==i.text().replace(/"/g,"")&&(r.data.pageWidth<=720?r.$e.win.scrollTop(i.offset().top-55):r.$e.win.scrollTop(i.offset().top))}),0==o.indexOf("\t")&&(o="1. &#12288;\n"+o),o},i.prototype._setFootnote=function(t){var r=[],a=l.trim(l("#template\\:footnote").text()).split(/[\r\n]+\s*/g);a[4]+=a[5]+a[6]+a[7]+a[8];var e="";if(t=(t=t.replace(/\[\^([ a-zA-Z\d]+)]: ?([\S\s]+?)(?=\[\^(?:[ a-zA-Z\d]+)]|\n\n|$)/g,function(t,e,i,n){var s="";return i=i.replace(/"(.*?)"\s*$/,function(t,e){return s=e,""}),r.push({index:n,note:e,content:i,title:s,used:!1}),""})).replace(/\[\^([ a-zA-Z\d]+)]/g,function(t,e){for(var i,n=0;i=r[n];n++)if(i.note==e)return i.used=!0,a[0].replace(/{{index}}/g,n+1+"").replace("{{title}}",i.title);var s=r.push({index:0,note:e,content:e,used:!0});return a[0].replace(/{{index}}/g,s+"")}),1<=r.length){for(var i,n=0;i=r[n];n++)i.used?e+=a[2].replace("{{index}}",n+1).replace("{{content}}",i.content).replace("{{back}}",a[4].replace("{{index}}",n+1)):e+=a[3].replace("{{content}}",i.content);e=a[1].replace("{{list}}",e)}return t+"\n<br>"+e},i.prototype._setJSCommentDisable=function(e){var t=l('<div class="lang-off-js-comment">注<i>/</i></div>');t.on("click",function(){var t=l(this);t.hasClass("on")?(t.removeClass("on"),e.find(".hljs-comment").show()):(t.addClass("on"),e.find(".hljs-comment").hide())}),e.prepend(t)},i.prototype._createFlowChart=function(t){var e=t.text();t.text("");var i="flowChart"+parseInt(500*Math.random());t.attr("id",i),flowchart.parse(e).drawSVG(i,{"line-width":1.3,"line-length":56,"line-color":"#666","text-margin":10,"font-size":12,font:"normal","font-family":"Helvetica","font-weight":"normal","font-color":"black","element-color":"#888",fill:"#fff","yes-text":"是","no-text":"否","arrow-end":"block-wide-long",symbols:{},flowstate:{}})},i.prototype._setTOC=function(t){return t.replace(/\[(TOC|MENU)]/g,'<blockquote class="markdown-contents"></blockquote>')},i.prototype._setImgResize=function(t){return t.replace(/<img(.*?)src="(.*?)=(\d*[-x×]\d*)(-[lrc])?"/g,function(t,e,i,n,s){var r="<img"+e+'src="'+i+'"',a=n.split(/[-x×]/),o={"-l":"left","-r":"right","-c":"center"}[s];return a[0]&&(r+=' width="'+a[0]+'"'),a[1]&&(r+=' height="'+a[1]+'"'),o&&(r+=' align="'+o+'"'),r})},i.prototype._setCheckbox=function(t){return t.replace(/\[([√×Xx\s\-_])\]\s(.*?)([<\n\r])/g,function(t,e,i,n,s){var r='<input type="checkbox" id="checkbox'+s+'"';return r+=/\s/.test(e)?">":'checked="true">',(r+='<label for="checkbox'+s+'">'+i+"</label>")+n})},i.prototype._setRedText=function(t){return t.replace(/==(.*?)==/g,function(t,e){return"<mark>"+e+"</mark>"})},i.prototype._createContents=function(t){var e=l(".markdown-contents").html(a(t));l("blockquote").each(function(){var t=l(this);1<t.find("ol>li>a").length&&(t.addClass("markdown-contents"),e=e.add(t))}),e.find("ol").each(function(){for(var t,e=l(this),i=e.children("li").children("a"),n=i.eq(0).text(),s=i.eq(1).text(),r=[/^[\(（]?(\d+\.?)+[^\d]{2,}/,/^[\(（【第]?[一二三四五六七八九十百千万壹贰叁肆伍陆柒捌玖拾佰仟]+/,/^(chapter)|(section)|(part)|(step)/i,/^[ⅠⅡⅢⅣIⅤⅥⅦⅧⅨⅩⅪⅫLCDM]+\.?/],a=0;t=r[a];a++)if(t.test(n)&&t.test(s)){e.addClass("unindex");break}});var r=function(n,s){0!=n.length&&n.children("li").each(function(t){var e=l(this);if(!n.hasClass("unindex")){var i="number"==typeof s?s+1+"."+(t+1):t+1+".";e.prepend("<i>"+i+"</i>")}r(e.children("ol"),t)})};e.children("ol").each(function(){r(l(this))})},i.prototype._encodeUrl=function(t,e){var i="library/";"string"==typeof AWConfig.libraryPrefix&&0<AWConfig.libraryPrefix.length&&(i=AWConfig.libraryPrefix.replace(/\\/g,"/").replace(/\/?&/,"/"));return"normal"==e?"utf8"==localStorage[o]?i+=encodeURI(t):"gbk"==localStorage[o]&&(i+=t.split("/").map(function(t){return GBK.encode(t)}).join("/")):"reverse"==e&&("utf8"==localStorage[o]?i+=t.split("/").map(function(t){return GBK.encode(t)}).join("/"):"gbk"==localStorage[o]&&(i+=encodeURI(t))),i+=".md?t="+(new Date).getTime()},i.prototype.renderDoc=function(t){var s=this,e="";this.cleanView(),t=this._setFootnote(t),e=a(t),e=this._setTOC(e),e=this._setImgResize(e),e=this._setCheckbox(e),e=this._setRedText(e),this.$e.view.html(e),this.$e.view.find("pre code").each(function(t,e){var i=l(e),n=i.attr("class")||"";0<=n.indexOf("lang-flow")?s._createFlowChart(i):0<=n.indexOf("lang")&&r.highlightBlock(e),0<=(n=i.attr("class")||"").indexOf("javascript")&&s._setJSCommentDisable(i)});var i=this.$e.view.find("h1").eq(0).text();this.$e.title.text(i),this.$e.contentsTitle.text(i).attr("href","#"+i.replace(/"/g,""));var n=this._setTitlesAnchor();this._createContents(n)},i.prototype.getDoc=function(t,e){var i={type:"get",url:t,dataType:"text"};l.ajax(i).done(function(t){if(/^\s*<!(DOCTYPE|doctype)/.test(t))return e("fail");e("done",t)}).fail(function(){e("fail")})},i.prototype.loadPage=function(n,s){var r=this,t=this._encodeUrl(n,"normal");this.getDoc(t,function(t,e){if("fail"==t){var i=r._encodeUrl(n,"reverse");r.getDoc(i,function(t){"fail"==t?s&&s("error"):"done"==t&&(localStorage[o]="utf8"==localStorage[o]?"gbk":"utf8",s&&s("success",e))})}else"done"==t&&s&&s("success",e)})},i.prototype.cleanView=function(){this.$e.view.find(".lang-off-js-comment").off("click"),this.$e.view.html("")},t.AWDocs=i}(window,document,jQuery),function(o,c){"use strict";var i=[];setInterval(function(){for(var t,e=0;t=i[e];e++)t.checkHeightWidth()},500);var t=function(t){this.$e={container:c(t),inner:null,barY:null,boxY:null,sliderY:null,barX:null,boxX:null,sliderX:null},this._data={xRolling:"true"==this.$e.container.attr("data-x-rolling"),maxTop:0,barH:0,sliderH:0,contentH:0,containerH:0,contentHLast:0,barW:0,sliderW:0,contentW:0,containerW:0,contentWLast:0},this._init()};t.prototype._init=function(){var t=this,e='<div class="scrollbar scrollbar-y" onselectstart="return false"><div><i></i></div></div>';e+=this._data.xRolling?'<div class="scrollbar scrollbar-x" onselectstart="return false"><div><i></i></div></div>':"",this.$e.container.append(e),this.$e.barY=this.$e.container.find(".scrollbar-y"),this.$e.boxY=this.$e.barY.children("div"),this.$e.sliderY=this.$e.barY.find("i"),this._data.xRolling&&(this.$e.barX=this.$e.container.find(".scrollbar-x"),this.$e.boxX=this.$e.barX.children("div"),this.$e.sliderX=this.$e.barX.find("i")),this.$e.inner=this.$e.container.children(".scroller-inner"),this._onWinResize(),c(o).on("resize",function(){t._onWinResize(),t.checkHeightWidth()}),this.$e.container.on("scrollbar",function(){t.checkHeightWidth()}),this.$e.inner.on({click:function(){t.checkHeightWidth()},scroll:function(){t._reScroll()}}),this.checkHeightWidth(),this._bindAction()},t.prototype._bindAction=function(){var e=this,i=!1,n=0,s=0,r=0,a=0;this.$e.body=c("body"),this.$e.boxY.on({mousedown:function(t){i="y",e.$e.body.attr("onselectstart","return false"),e.$e.barY.addClass("active"),n=t.pageY,s=parseFloat(e.$e.sliderY.css("top")),0<e.$e.barY.parents("#main").length&&e.$e.body.children("aside").hide()}}),this._data.xRolling&&this.$e.boxX.on({mousedown:function(t){i="x",e.$e.body.attr("onselectstart","return false"),e.$e.barX.addClass("active"),r=t.pageX,a=parseFloat(e.$e.sliderX.css("left"))}}),c(o.document).on({mousemove:function(t){"y"==i?e.scrollYTo(s+t.pageY-n):"x"==i&&e.scrollXTo(a+t.pageX-r)},mouseup:function(){e.$e.body.removeAttr("onselectstart","return false").children("aside").show(),"y"==i?e.$e.barY.removeClass("active"):"x"==i&&e.$e.barX.removeClass("active"),i=!1}})},t.prototype._onWinResize=function(){isMobi()?this.$e.inner.removeAttr("style").removeClass("on"):this.$e.inner.css({width:this.$e.container.width()+30,paddingRight:13,paddingBottom:16}).addClass("on")},t.prototype._resize=function(){this._data.containerH=this.$e.inner.height(),this._data.contentH<=this._data.containerH?(this._data.contentH=this._data.containerH,this.$e.barY.addClass("off")):this.$e.barY.removeClass("off"),this._data.barH=this.$e.boxY.height(),this._data.sliderH=this._data.containerH/this._data.contentH*this._data.barH,this.$e.sliderY.height(this._data.sliderH),this._data.maxTop=(this._data.barH-this._data.sliderH)/this._data.barH*this._data.contentH+1,this._data.xRolling&&(this._data.containerW=this.$e.inner.width(),this._data.contentW<=this._data.containerW?(this._data.contentW=this._data.containerW,this.$e.barX.addClass("off")):this.$e.barX.removeClass("off"),this._data.barW=this.$e.boxX.width(),this._data.sliderW=this._data.containerW/this._data.contentW*this._data.barW,this.$e.sliderX.width(this._data.sliderW))},t.prototype._reScroll=function(){var t=this.$e.inner.scrollTop()/this._data.contentH*this._data.barH;if(t+this._data.sliderH>=this._data.barH?(t=this._data.barH-this._data.sliderH,this.$e.sliderY.css("top",t),this.$e.inner.scrollTop(this._data.maxTop)):this.$e.sliderY.css("top",t),this._data.xRolling){var e=this.$e.inner.scrollLeft()/this._data.contentW*this._data.barW;this.$e.sliderX.css("left",e)}},t.prototype.scrollYTo=function(t){var e=t;e=(e=e<0?0:e)+this._data.sliderH>this._data.barH?this._data.barH-this._data.sliderH:e,this.$e.sliderY.css("top",e),this.$e.inner.scrollTop(e/this._data.barH*this._data.contentH)},t.prototype.scrollXTo=function(t){var e=t;e=(e=e<0?0:e)+this._data.sliderW>this._data.barW?this._data.barW-this._data.sliderW:e,this.$e.sliderX.css("left",e),this.$e.inner.scrollLeft(e/this._data.barW*this._data.contentW)},t.prototype.checkHeightWidth=function(){var t=this;this._data.contentH=0,this._data.contentW=0,this.$e.inner.children(".scroller-content").each(function(){t._data.contentH+=c(this).outerHeight(),t._data.contentW+=c(this).outerWidth()}),/webkit/.test(navigator.userAgent.toLowerCase())&&(t._data.contentH+=15),this._data.contentH==this._data.contentHLast&&this._data.contentW==this._data.contentWLast||(this._data.contentHLast=this._data.contentH,this._data.contentWLast=this._data.contentW,this._resize(),this._reScroll())},c.extend(c.fn,{scrollbar:function(){return this.each(function(){i.push(new t(this))})}})}(window,jQuery),function(t,i){"use strict";var e=function(t){this.$e={container:i(t),imgList:null,imgsView:i("#imgsView"),imgsViewInner:null,btnPrev:null,btnNext:null},this._data={winW:0,winH:0,curIndex:-1},this._init()};e.prototype._init=function(){var e=this;this.$e.imgsViewInner=this.$e.imgsView.find("#imgsViewInner"),this.$e.btnPrev=this.$e.imgsView.find(".prev"),this.$e.btnNext=this.$e.imgsView.find(".next"),this._data.winW=i(t).width(),this._data.winH=i(t).height(),this.$e.container.on("click",function(t){"img"==t.target.tagName.toLowerCase()&&(e.$e.imgList=e.$e.container.find("img"),e._data.curIndex=e.$e.imgList.index(t.target),e.open())}),this.$e.imgsView.children(".imgsv-background").on("click",function(){e.close()}),this.$e.imgsView.find(".original").on("click",function(){e.resizeAs("org")}),this.$e.imgsView.find(".suit").on("click",function(){e.resizeAs("suit")}),this.$e.imgsView.find(".prev").on("click",function(){i(this).hasClass("off")||e.playTo(e._data.curIndex-1)}),this.$e.imgsView.find(".next").on("click",function(){i(this).hasClass("off")||e.playTo(e._data.curIndex+1)})},e.prototype.open=function(){var t=this;this.playTo(this._data.curIndex),this.$e.imgsView.fadeIn(80),setTimeout(function(){t.$e.imgsView.addClass("on")},50)},e.prototype.close=function(){var t=this;this.$e.imgsView.removeClass("on"),setTimeout(function(){t.$e.imgsView.fadeOut(50)},200),t.$e.imgList=null,t._data.curIndex=-1},e.prototype.playTo=function(t){0==t?this.$e.btnPrev.addClass("off"):this.$e.btnPrev.removeClass("off"),t==this.$e.imgList.length-1?this.$e.btnNext.addClass("off"):this.$e.btnNext.removeClass("off"),this.$e.imgCur=this.$e.imgList.eq(t).clone().removeAttr("align"),this.resizeAs("suit"),this.$e.imgsViewInner.html(this.$e.imgCur),this._data.curIndex=t},e.prototype.resizeAs=function(t){"suit"==t?(this.$e.imgCur.removeAttr("width").removeAttr("height"),this.$e.imgCur[0].naturalWidth>this._data.winW-60&&this.$e.imgCur.css("max-width",this._data.winW-60),this.$e.imgCur[0].naturalHeight>this._data.winH-60&&this.$e.imgCur.css("max-height",this._data.winH-60)):"org"==t&&(this.$e.imgCur.removeAttr("style"),this.$e.imgCur.attr({width:this.$e.imgCur[0].naturalWidth,height:this.$e.imgCur[0].naturalHeight}))},i.extend(i.fn,{imgsView:function(){return this.each(function(){return new e(this)})}})}(window,jQuery),$(function(){"use strict";var i=window.tools,a=new AWDocs,o=new AWStorage,s=new AWSearch(o);if(window.AWTesting)var r=new AWTesting;var t,e,c="pushState"in history,n=$(window),l=($("body"),$("#menuIcon")),h=$("#container"),d=$("#nav"),u=$("#menuBar"),f=$("#menuFilter"),p=f.next("i"),g=$("#main"),m=g.children(".main-inner"),v=$("#mainSibling"),_=$("#contents"),w=window.isMobi=(t=n.width(),(e=function(){(t=n.width())<=720?h.removeAttr("style"):h.height(n.height()-70-15-40)})(),n.on("resize",e),function(){return t<=720});u.on("click","h4",function(){var t=$(this);t.hasClass("on")||(t.addClass("on"),u.find("a").removeClass("on")),u.find("h5").removeClass("on").next("ul").hide()}),u.on("click","h5",function(){var t=$(this),e=t.next("ul");t.hasClass("on")?(t.removeClass("on"),e.slideUp(200,function(){u.trigger("scrollbar")})):(t.addClass("on"),e.slideDown(200,function(){u.trigger("scrollbar")}))}),u.on("click","strong",function(){var t=$(this),e=t.next("ul");t.hasClass("on")?(t.removeClass("on"),e.slideUp(200,function(){u.trigger("scrollbar")})):(t.addClass("on"),e.slideDown(200,function(){u.trigger("scrollbar")}))}),l.on("click",function(){var t=$(this);t.hasClass("close")?(t.removeClass("close").find("use").attr("xlink:href","#icon:navStart"),d.removeClass("on")):(t.addClass("close").find("use").attr("xlink:href","#icon:navClose"),d.addClass("on"))}),d.on("navchange searchon searchoff",function(t){l.removeClass("close").find("use").attr("xlink:href","#icon:navStart"),d.removeClass("on")}),f.on("input propertychange input2",function(){var t=f.val().replace(/([\(\)\[\]\^\$\+])/g,"\\$1"),e=new RegExp("("+$.trim(f.val()).split(/[ ,]/).join("|")+")","ig");""==t||/^\s$/g.test(t)?(p.addClass("off"),u.find("h5").each(function(){x("open",null,$(this))}),o.setStates("navFilterKey")):(p.removeClass("off"),u.find("h5").each(function(){x("filter",e,$(this))}),o.setStates("navFilterKey",t)),u.trigger("scrollbar")}),p.on("click",function(){f.val("").trigger("input2")}),sessionStorage.AMWikiIconsSvg?$("#svgSymbols").append(sessionStorage.AMWikiIconsSvg):$.get("amWiki/images/icons.svg",function(t){sessionStorage.AMWikiIconsSvg=t,$("#svgSymbols").append(t)},"text").fail(function(){"undefined"!=typeof AWPageMounts&&(sessionStorage.AMWikiIconsSvg=AWPageMounts.icon.content,$("#svgSymbols").append(AWPageMounts.icon.content))}),_.children(".btn").on("click",function(t){_.toggleClass("on").removeClass("hover")}),_.hover(function(){_.addClass("hover")},function(){_.removeClass("hover")}),$(".scroller").scrollbar(),$("#backTop").on("click",function(){m.scrollTop(0)}),g.imgsView(),$(document).on("click",function(t){var e=$(t.target);w()&&0==e.closest("#contents").length&&_.removeClass("on").removeClass("on")});var b,y,x=function(t,i,e){var n=e.next("ul"),s=e.find("span");"filter"==t&&i?i.test(s.text())?(s.html(s.text().replace(i,"<mark>$1</mark>")),e.addClass("on").removeClass("off"),n.show().find("> li > a").each(function(){var t=$(this),e=t.find("span");e.html(e.text().replace(i,"<mark>$1</mark>")),t.parent().removeClass("off")}),C(e),n.find("> li > strong").each(function(){x("open",i,$(this))})):(s.text(s.text()),e.removeClass("on"),e.is("h5")?e.parent().addClass("off"):e.addClass("off"),n.hide().find("> li > a").each(function(){var t=$(this),e=t.find("span");i.test(t.text())?(e.html(e.text().replace(i,"<mark>$1</mark>")),t.parent().removeClass("off"),C(n.show().prev())):(e.text(e.text()),t.parent().addClass("off"))}),n.find("> li > strong").each(function(){x("filter",i,$(this))})):"open"==t&&(e.removeClass("off"),e.hasClass("on")?n.show():n.hide(),i?(s.html(s.text().replace(i,"<mark>$1</mark>")),i.test(s.text())&&n.show(),n.find("> li > a").each(function(){var t=$(this),e=t.find("span");e.html(e.text().replace(i,"<mark>$1</mark>")),i.test(t.text())&&n.show(),t.parent().removeClass("off")}),C(e),n.find("> li > strong").each(function(){x("open",i,$(this))})):(s.text(s.text()),n.find("> li > a").each(function(){var t=$(this).find("span");t.text(t.text())}),n.children("li").removeClass("off").children("strong").each(function(){x("open",null,$(this))})))},C=function(t){if(t.addClass("on").removeClass("off"),!t.is("h5")){var e=t.parent().removeClass("off").parent().show().prev();C(e)}},k=function(t){if(t){var n=function(t,e){var i=e[t]();return 0==i.length?null:0<i.children("ul").length?n(t,i):i.children("a")},e=function(t,e){e?v.find("a").eq(t).attr("href",e.attr("href")).text(e.text()):v.find("a").eq(t).removeAttr("href").text("没有了")};e(0,n("prev",t)),e(1,n("next",t)),r&&!r.isOpen()&&v.addClass("on")}else v.removeClass("on")},S=function(i){if(/^home[-_].*?/.test(i)||"首页"==i)u.find("h4").addClass("on"),u.find("a").removeClass("on"),k(null);else{var n=!1;u.find("a").each(function(){var t=$(this);if(t.attr("href").split("file=")[1]==i){n=!0;var e=t.addClass("on").parent().parent().show().prev().addClass("on");C(e),k(t.parent())}else t.removeClass("on")}),n&&u.find("h4").removeClass("on")}H=i,u.trigger("scrollbar")},W=function(i,t,n){var s=o.read(i);if(a.renderDoc(s),r&&r.crawlContent(),g.trigger("scrollbar"),m.scrollTop(0),!t&&c){var e=i.replace(/&/g,"%26");history.pushState({path:i},"","?file="+e)}a.loadPage(i,function(t,e){"error"==t?""==s?(a.loadPage(A.path,function(t,e){"success"==t&&(S(A.path),a.renderDoc(e),o.saveDoc(A.path,e),g.trigger("scrollbar"))}),c&&history.replaceState({path:A.path},"",A.url)):(o.increaseOpenedCount(i),n&&n()):"success"==t&&(e!=s&&(a.renderDoc(e),o.saveDoc(i,e),r&&r.crawlContent(),g.trigger("scrollbar")),o.increaseOpenedCount(i),n&&n())})},A={},T=function(){var t=location.hash.split("#")[1];if(t&&""!=t.length){var e=$('.anchor[name="'+t+'"]');0!=e.length&&m.scrollTop(e.position().top+m.scrollTop()-10)}else 0!=m.scrollTop()&&m.scrollTop(0)},H=i.getURLParameter("file");H=(H=H?decodeURI(H):"首页").replace(/%26/g,"&"),b=function(t){o.checkLibChange(t),function(){if("undefined"!=typeof AWPageMounts){var t=AWPageMounts.home.name.replace(/\.md$/,""),e=o.readTime(t);if(AWPageMounts.home.timestamp>e){for(var i in o.saveDoc(t,AWPageMounts.home.content),delete AWPageMounts.home,AWPageMounts)if(AWPageMounts.hasOwnProperty(i)&&/^m\d+/.test(i)){for(var n,s=0;n=AWPageMounts[i][s];s++)o.saveDoc(n.path.replace(/\.md$/,""),n.content);delete AWPageMounts[i]}o.saveRebuild()}else for(var r in delete AWPageMounts.home,AWPageMounts)AWPageMounts.hasOwnProperty(r)&&/^m\d+/.test(r)&&delete AWPageMounts[r]}}(),S(H),W(H,!0,T)},y=function(t){u.find(".scroller-content").html(marked(t));var e=u.find("h4");A.text=e.text(),A.url=e.find("a").attr("href"),A.path=A.url.split("file=")[1],e.prepend('<svg><use xlink:href="#icon:navHome"></use></svg>'),u.find("h5").each(function(){var t=$(this);t.html('<svg><use xlink:href="#icon:navArrow"></use></svg><span>'+t.text()+"</span>")}),u.trigger("scrollbar");var i=[];u.find("a").each(function(){var t=$(this);if(t.html("<span>"+t.text()+"</span>"),c){var e=t.attr("href").split("file=")[1];i.push(e),t.on("click",function(){return s.displayBox("off"),S(e),W(e),t.trigger("navchange"),!1})}}),v.find("a").on("click",function(){if(c){var t=$(this),e=t.attr("href");if(void 0!==e&&""!=e){var i=e.split("file=")[1];S(i),W(i),t.trigger("navchange")}return!1}}),u.find("strong").each(function(){var t=$(this);t.html("<span>"+t.text()+"</span>")}),$("#results").on("click","a",function(){if(c){var t=$(this),e=t.attr("href");if(void 0!==e&&""!=e){var i=e.split("file=")[1];s.displayBox("off"),S(i),W(i),t.trigger("navchange")}return!1}});var n=o.getStates("navFilterKey");void 0!==n&&""!=n&&f.val(n).trigger("input2"),b&&b(i)},$.get("library/$navigation.md?t="+Date.now(),y,"text").fail(function(){"undefined"!=typeof AWPageMounts&&y(AWPageMounts.nav.content)}),c&&n.on("popstate",function(t){var e;t.originalEvent.state?(e=(e=t.originalEvent.state.path).replace(/%26/g,"&"),S(e),W(e,!0,T)):(e=(e=(e=i.getURLParameter("file"))?decodeURI(e):"首页").replace(/%26/g,"&"))!=H?(S(e),W(e,!0,T)):T()}),s.onNeedRebuildStorage=function(n){o.clearLibraries();for(var t,s=o.getIndexList(),r=0,e=function(i,t){setTimeout(function(){a.loadPage(i,function(t,e){"success"==t&&o.saveDocToDB(i,e),++r>=s.length&&(o.saveRebuild(),n&&n())})},100*t)},i=0;t=s[i];i++)e(t,i)}});